-- 1. Lista zadań z tabeli ISSUES wraz z nazwami list zadań (ISSUESLISTS)
SELECT I.ID, I.SUMMARY, I.DESCRIPTION, IL.NAME AS ISSUE_LIST_NAME
FROM ISSUES I
JOIN ISSUESLISTS IL ON I.ISSUESLIST_ID = IL.ID;

-- 2. Lista zadań z tabeli ISSUES z przypisanymi do nich użytkownikami (USERS)
SELECT I.ID, I.SUMMARY, I.DESCRIPTION, U.FIRSTNAME, U.LASTNAME
FROM ISSUES I
JOIN USERS U ON I.USER_ID_ASSIGNEDTO = U.ID;

-- 3. Imiona i nazwiska użytkowników oraz liczba przypisanych do nich zadań
SELECT U.FIRSTNAME, U.LASTNAME, COUNT(I.ID) AS TASK_COUNT
FROM USERS U
LEFT JOIN ISSUES I ON U.ID = I.USER_ID_ASSIGNEDTO
GROUP BY U.FIRSTNAME, U.LASTNAME
ORDER BY TASK_COUNT DESC;
